const $=e=>document.querySelector(e),$all=e=>document.querySelectorAll(e);function Contaxion(e){if(""===e.toEmail)throw alert("Recipient email address is required in contaxion config"),new Error("Recipient email address is required");this.userEmail=e.toEmail,this.parent=e.parent,this.openFormBtn=e.openFormBtn,this.openFormBtnShadow=e.openFormBtnShadow,this.headerColor=e.headerColor,this.buttonColor=e.buttonColor,this.usernamePlaceholder=e.usernamePlaceholder,this.emailPlaceholder=e.emailPlaceholder,this.mesagePlaceholder=e.messagePlaceholder,this.formTitle=e.formTitle,this.loading=!1,this.isOpen=!0,this.randColor=e.genRandColor,this.defaultHeaderColor="linear-gradient(90deg, var(--pink1) 0%, var(--pink2) 99%);",this.defaultSubmitBtnColor="linear-gradient(90deg, var(--pink1) 0%, var(--pink2) 99%);",this.defaultOpenFormBtn="linear-gradient(90deg, var(--pink1) 0%, var(--pink2) 99%);",this.sendBtn=$(".send-btn"),this.error=(e=>{let t=new Error(e);return console.error(t)}),this.createContaxionDialog=(()=>`\n        <div class="dialog-cont">\n            <div class="dialog-box">\n                <div class="head contaxion-header" style="background:${void 0===this.headerColor?this.defaultHeaderColor:this.headerColor};">\n                    <p>${void 0===this.formTitle?"Contact Us":this.formTitle}</p>\n                    <ion-icon name="close-outline" class="close-btn"></ion-icon>\n                </div>\n                <div class="form-cont">\n                    <form class="form-group">\n                        <small class="msg"></small>\n\n                        <input type="text" class="username inp form-control" placeholder="${null==this.usernamePlaceholder?"username":this.usernamePlaceholder}" required>\n                        <input type="email" class="email inp form-control" placeholder="${null==this.emailPlaceholder?"email":this.emailPlaceholder}" required>\n                        <textarea class="message form-control" cols="30" rows="5" placeholder="${null==this.messagePlaceholder?"Message here":this.messagePlaceholder}" required></textarea>\n                        <br />\n                        <button class="btn send-btn" style="background:${void 0===this.buttonColor?this.defaultSubmitBtnColor:this.buttonColor};">Submit</button>\n                    </form>\n                </div>\n                \n            </div>\n            <ion-icon name="call-outline" class="openform" style="background: ${void 0===this.openFormBtn?this.defaultOpenFormBtn:this.openFormBtn}; box-shadow:0px 0px 12px ${void 0===this.openFormBtnShadow?"var(--pink1)":this.openFormBtnShadow}"></ion-icon>\n        </div>\n        `),this.toggleForm=(()=>{let e=$(".dialog-box"),t=$(".openform"),n=$(".close-btn");!1===this.isOpen?(e.style.display="none",t.style.display="block",this.isOpen=!0):(e.style.display="block",t.style.display="none",this.isOpen=!1),n.onclick=(()=>{e.style.display="none",t.style.display="block",this.isOpen=!1}),t.onclick=(()=>{e.style.display="block",t.style.display="none",this.isOpen=!0})}),this.genRandColor=(()=>{let e=$(".contaxion-header"),t=$(".send-btn"),n=$(".openform"),o="#6495ED,#008B8B,#2F4F4F,#1E90FF,#4B0082,#FFF0F5,#20B2AA,#87CEFA,#778899,#008080".split(","),i=o[Math.floor(Math.random()*o.length)];!0!==this.randColor&&void 0!==this.genRandColor||(e.style=`background: ${i}`,t.style=`background: ${i}`,n.style=`background: ${i}`)}),this.handleFormValidation=(()=>{let e=$(".send-btn"),t=$(".username"),n=$(".email"),o=$(".message"),i=$(".msg");e.onclick=(e=>{if(e.preventDefault(),""===t.value||""===n.value||""===o.value)return i.textContent="Fields cant be empty",void i.setAttribute("class","error");i.innerHTML="",i.removeAttribute("error"),this.sendFormData(t.value,n.value,o.value,i)})}),this.sendFormData=(async(t,n,o,i)=>{if(""===e.toEmail)return i.innerHTML="To email is missing in configuration.",i.classList.add("failure"),void i.removeAttribute("success");let s=$(".send-btn"),r=$(".username"),a=$(".email"),l=$(".message");i.innerHTML="",i.removeAttribute("error"),s.textContent="Sending....",s.setAttribute("disabled","true"),s.classList.add("loading");let d={to:e.toEmail,username:t,email:n,message:o};try{let e="http://localhost:5000/api/sendMail",t=await fetch(e,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(d)});await t.json();200===t.status?(s.removeAttribute("disabled"),s.classList.remove("loading"),s.textContent="Submit",i.innerHTML="",i.innerHTML="Message sent succesfully..",i.removeAttribute("failure"),i.setAttribute("class","success"),r.value="",a.value="",l.value="",setTimeout(()=>{i.textContent=""},3e3)):200!==t.status&&(s.removeAttribute("disabled"),s.classList.remove("loading"),s.textContent="Submit",i.innerHTML="Something went wrong while sending message, please try again later.",i.removeAttribute("success"),i.classList.add("failure"),setTimeout(()=>{""!==i.innerHTML&&(i.innerHTML="")},3e3))}catch(e){console.log(e),i.removeAttribute("success"),i.setAttribute("class","failure"),i.textContent="Something went wrong, internal server error. Please try later.",s.removeAttribute("disabled"),s.classList.remove("loading"),s.textContent="Submit"}}),this.init=(()=>{let e=document.createElement("script"),t=document.createElement("script");e.type="module",t.setAttribute("nomodule","nomodule"),e.src="https://unpkg.com/ionicons@5.5.2/dist/ionicons/ionicons.esm.js",t.src="https://unpkg.com/ionicons@5.5.2/dist/ionicons/ionicons.js",document.body.append(e),document.body.append(t);let n=$(this.parent);if(null===n)return this.error(`Cant access parent element with class name "${this.parent}"`);let o=document.createElement("div");o.innerHTML=this.createContaxionDialog(),n.innerHTML="",n.append(o),this.toggleForm(),this.handleFormValidation(),!0===this.randColor&&this.genRandColor()})}